name: goae
version: 0.4.1
inherits: michilu/goapp@1.9.35
type : main
platform : ubuntu@12.04
description : golang
keywords:
  - golang
  - appengine
  - nodejs
  - go
  - dc
  - cloc
packages :
  - nodejs@4.4.1
script : |
  curl -sL https://deb.nodesource.com/setup_4.x | sudo -E bash -
  sudo apt-get install -y nodejs dc

  curl -sL http://nchc.dl.sourceforge.net/project/cloc/cloc/v1.64/cloc-1.64.pl | sudo cat - > /usr/local/bin/cloc-1.64.pl
  sudo echo<<EOD > /usr/local/bin/cloc
  #!/bin/sh
  #perl /usr/local/bin/cloc-1.64.pl $*
  EOD
  sudo chmod 755 /usr/local/bin/cloc

  # Workaround for 1.9.35 SDK

  export SDK_LOCATION="$(dirname $(which goapp))"
  echo "Fixing go build tags"

  cd $SDK_LOCATION
  sudo ./goapp install cmd/go
  sudo mv goroot/bin/go goroot/bin/goapp
  sudo ./goapp install cmd/cover
